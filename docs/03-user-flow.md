# 03. User Flow

## 1. GUI 애플리케이션 흐름

### 1.1 애플리케이션 시작

```
┌─────────────────────────────────────────────────────────────┐
│                    앱 실행 (python src/app.py)              │
└──────────────────────────┬──────────────────────────────────┘
                           │
                           ▼
              ┌────────────────────────┐
              │  .env.local 로드       │
              │  (API 키 자동 설정)    │
              └───────────┬────────────┘
                          │
                          ▼
              ┌────────────────────────┐
              │  SQLite DB 연결        │
              │  (data/db/chat_history.db)│
              └───────────┬────────────┘
                          │
                          ▼
              ┌────────────────────────┐
              │  메인 윈도우 표시      │
              │  - 채팅방 목록 로드    │
              │  - 대시보드 탭 활성화  │
              └────────────────────────┘
```

---

### 1.2 채팅방 관리 흐름

```
┌─────────────────────────────────────────────────────────────┐
│                       메인 화면                             │
├─────────────────────────────────────────────────────────────┤
│  ┌───────────────┐  ┌─────────────────────────────────────┐ │
│  │  채팅방 목록  │  │          콘텐츠 영역               │ │
│  │  ──────────── │  │  ┌─────────────────────────────────┐│ │
│  │  📁 바이브랩스│  │  │  📊 대시보드 | 📅 날짜별 | 🔗 URL ││ │
│  │  📁 스터디방  │  │  │─────────────────────────────────││ │
│  │               │  │  │                                 ││ │
│  │  [➕ 채팅방]  │  │  │    통계 / 요약 / URL 정보      ││ │
│  │  [📤 업로드]  │  │  │                                 ││ │
│  └───────────────┘  │  └─────────────────────────────────┘│ │
│                     └─────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

---

## 2. 주요 사용 시나리오

### 시나리오 A: 새 채팅방 추가 및 파일 업로드

```
[➕ 채팅방 만들기] 클릭
        │
        ▼
┌────────────────────────┐
│  채팅방 이름 입력      │
│  예: "바이브랩스"      │
└───────────┬────────────┘
            │
            ▼
┌────────────────────────┐
│  채팅방 생성 완료      │
│  - DB에 레코드 생성    │
│  - 디렉터리 생성       │
│    data/original/바이브랩스/
│    data/summary/바이브랩스/
└───────────┬────────────┘
            │
            ▼
[📤 파일 업로드] 클릭
        │
        ▼
┌────────────────────────┐
│  채팅방 선택           │
│  파일 선택 (.txt)      │
└───────────┬────────────┘
            │
            ▼
┌────────────────────────┐
│  백그라운드 처리       │
│  - 파일 파싱           │
│  - 날짜별 그룹화       │
│  - DB 저장 (중복 체크) │
│  - 파일 저장           │
│  - 기존 요약 무효화    │
└───────────┬────────────┘
            │
            ▼
┌────────────────────────┐
│  업로드 완료 알림      │
│  "2024-01-20 ~ 01-25   │
│   총 1,234개 메시지"   │
└────────────────────────┘
```

---

### 시나리오 B: 요약 생성

```
[🔄 요약 생성] 클릭
        │
        ▼
┌────────────────────────┐
│  요약 옵션 다이얼로그  │
│  ──────────────────── │
│  📅 날짜 범위:         │
│    ○ 오늘             │
│    ○ 어제~오늘        │
│    ○ 최근 7일         │
│    ○ 전체 날짜        │
│    ● 요약 필요한 날짜만│
│  ──────────────────── │
│  🤖 LLM 선택:          │
│    [Z.AI GLM ▼]        │
│    API 상태: ✅ 설정됨 │
│  ──────────────────── │
│  ☑ 이미 완료된 날짜 건너뛰기│
│  ──────────────────── │
│  📊 요약 현황:         │
│    전체: 30일 / 완료: 25일│
│    신규: 3일 / 업데이트: 2일│
└───────────┬────────────┘
            │
            ▼
┌────────────────────────┐
│  요약 진행 다이얼로그  │
│  ──────────────────── │
│  🤖 Z.AI GLM 요약 생성 │
│  ──────────────────── │
│  ▓▓▓▓▓▓▓░░░░░░░ 45%  │
│  ──────────────────── │
│  📅 2024-01-23 처리 중...│
│  ──────────────────── │
│        [취소]          │
└───────────┬────────────┘
            │
            ▼
┌────────────────────────┐
│  완료 알림             │
│  ✅ 5개 날짜 요약 완료 │
└────────────────────────┘
```

---

### 시나리오 C: 날짜별 요약 조회

```
[📅 날짜별 요약] 탭 클릭
        │
        ▼
┌────────────────────────────────────────────────────┐
│  ◀ 이전    📅 2024년 01월 23일    📆    다음 ▶   │
├────────────────────────────────────────────────────┤
│  📊 123개 메시지 / 요약 있음                       │
├────────────────────────────────────────────────────┤
│                                                    │
│  ## 🌟 3줄 요약                                    │
│  1. 새 프로젝트 킥오프 회의 진행                   │
│  2. 기술 스택 논의 (Python, FastAPI)               │
│  3. 다음 주 스프린트 계획 수립                     │
│                                                    │
│  ## ❓ Q&A 및 해결된 문제                          │
│  - Q: FastAPI vs Django?                           │
│    A: 빠른 개발에는 FastAPI 권장                   │
│  ...                                               │
│                                                    │
└────────────────────────────────────────────────────┘
```

---

### 시나리오 D: URL 정보 조회

```
[🔗 URL 정보] 탭 클릭
        │
        ▼
┌────────────────────────────────────────────────────┐
│  🔗 URL 정보              [🔄 동기화] [📂 파일 복구]│
├────────────────────────────────────────────────────┤
│                                                    │
│  📊 총 415개 URL                                   │
│  ─────────────────────────────────────────────────│
│                                                    │
│  🔥 최근 3일 (25개)                                │
│  ─────────────────────────────────────────────────│
│    #1 https://example.com/today                   │
│        : 오늘 공유된 링크                          │
│                                                    │
│  📅 최근 1주 (98개)                                │
│  ─────────────────────────────────────────────────│
│    #1 https://example.com/weekly                  │
│        : 이번 주 공유된 링크                       │
│                                                    │
│  📚 전체 URL (415개)                               │
│  ─────────────────────────────────────────────────│
│    #1 https://fastapi.tiangolo.com                │
│        : FastAPI 공식 문서                         │
│    #2 https://github.com/example/project          │
│        : 프로젝트 레포 / 소스코드 저장소           │
│  ...                                               │
└────────────────────────────────────────────────────┘
```

---

### 시나리오 E: DB 복구

```
[도구] 메뉴 → [🔧 DB 복구...]
        │
        ▼
┌────────────────────────┐
│  확인 다이얼로그       │
│  ──────────────────── │
│  data/original 및      │
│  data/summary 파일에서 │
│  DB를 복구합니다.      │
│                        │
│  기존 DB는 삭제됩니다. │
│  계속하시겠습니까?     │
│                        │
│  [취소]     [복구]     │
└───────────┬────────────┘
            │
            ▼
┌────────────────────────┐
│  복구 진행             │
│  ──────────────────── │
│  🔧 바이브랩스 복구 중...│
│  ▓▓▓▓▓▓▓▓░░░░░░ 60%  │
└───────────┬────────────┘
            │
            ▼
┌────────────────────────┐
│  복구 완료 알림        │
│  ✅ 2개 채팅방,        │
│     150개 메시지,      │
│     45개 요약 복구됨   │
└────────────────────────┘
```

---

## 3. CLI 사용 (선택)

`src/manual/` 디렉터리의 CLI 스크립트도 별도 사용 가능:

```bash
# 상세 요약
python src/manual/full_date_summary.py data/채팅방.txt
python src/manual/full_yesterday_summary.py --llm minimax data/

# 간결 요약 (음슴체)
python src/manual/simple_date_summary.py data/채팅방.txt
python src/manual/simple_today_summary.py --llm glm data/
```

---

## 4. 상태바 표시

```
┌────────────────────────────────────────────────────────────────┐
│  ✅ 준비                                            (15:30:25) │
│  ⏳ 요약 생성 중... (3/5)                           (15:31:10) │
│  ✅ 요약 생성 완료                                  (15:32:45) │
│  ❌ 요약 생성 실패                                  (15:32:45) │
└────────────────────────────────────────────────────────────────┘

아이콘 의미:
  ✅ 성공/준비 완료
  ⏳ 작업 진행 중
  ❌ 실패
  ⚠️ 경고
  ℹ️ 정보
```
