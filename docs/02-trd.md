# 02. Technical Requirements Document (TRD)

## 1. μ‹μ¤ν… μ•„ν‚¤ν…μ²

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              date_summarizer.py / yesterday_summarizer.py    β”‚
β”‚                      (λ©”μΈ μ¤μΌ€μ¤νΈλ μ΄ν„°)                     β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚                                                             β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚  β”‚   parser.py  β”‚  β”‚ chat_processor β”‚  β”‚  url_extractor   β”‚ β”‚
β”‚  β”‚  (νμ‹± λ¨λ“) β”‚  β”‚   (μ”μ•½ λ¨λ“)   β”‚  β”‚   (URL μ¶”μ¶)     β”‚ β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β” β”‚
β”‚         β”‚                 β”‚                     β”‚           β”‚
β”‚         β”‚         β”β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”           β”‚           β”‚
β”‚         β”‚         β”‚  llm_client.py β”‚           β”‚           β”‚
β”‚         β”‚         β”‚ (ν†µν•© LLM API)  β”‚           β”‚           β”‚
β”‚         β”‚         β””β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”           β”‚           β”‚
β”‚         β”‚                 β”‚                     β”‚           β”‚
β”‚         β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”           β”‚
β”‚                           β”‚                                 β”‚
β”‚                   β”β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”                       β”‚
β”‚                   β”‚   config.py    β”‚                       β”‚
β”‚                   β”‚ (λ‹¤μ¤‘ LLM μ„¤μ •) β”‚                       β”‚
β”‚                   β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                       β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## 2. λ¨λ“ μƒμ„Έ

### 2.1 config.py
**μ—­ν• **: μ „μ—­ μ„¤μ • λ° λ‹¤μ¤‘ LLM μ κ³µμ κ΄€λ¦¬

**LLM μ κ³µμ μ„¤μ •**:
| Provider | API URL | Model | ν™κ²½λ³€μ | API νΈν™μ„± | λΉ„κ³  |
|----------|---------|-------|----------|------------|------|
| glm | .../api/coding/paas/v4/chat/completions | glm-4.7 | ZAI_API_KEY | OpenAI | κΈ°λ³Έ, κ¶μ¥ |
| minimax | .../v1/chat/completions | MiniMax-M2.1 | MINIMAX_API_KEY | OpenAI | κ³ μ† |
| perplexity | .../chat/completions | sonar | PERPLEXITY_API_KEY | OpenAI | |
| chatgpt | .../v1/chat/completions | gpt-4o-mini | OPENAI_API_KEY | OpenAI | β οΈ 3 RPM |

> π“ **API νΈν™μ„± μ›μΉ™**: λ¨λ“  LLM μ κ³µμλ” **OpenAI νΈν™ API** (`/chat/completions` μ—”λ“ν¬μΈνΈ)λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. Anthropic(Claude) ν•μ‹μ€ ν„μ¬ μ§€μ›ν•μ§€ μ•μµλ‹λ‹¤.

**μ£Όμ” λ©”μ„λ“**:
| λ©”μ„λ“ | μ„¤λ… |
|--------|------|
| `set_provider(provider)` | LLM μ κ³µμ λ³€κ²½ |
| `get_provider_info()` | ν„μ¬ μ κ³µμ μ •λ³΄ λ°ν™ |
| `get_api_key(provider)` | μ§€μ • μ κ³µμμ API ν‚¤ λ°ν™ |
| `set_api_key(key, provider)` | λ°νƒ€μ„ API ν‚¤ μ„¤μ • |

---

### 2.2 llm_client.py
**μ—­ν• **: ν†µν•© LLM API ν΄λΌμ΄μ–ΈνΈ

**ν΄λμ¤**: `LLMClient`

**API νΈν™μ„±**: OpenAI νΈν™ API ν•μ‹λ§ μ§€μ›
- μ”μ²­ ν•μ‹: `{"model": "...", "messages": [{"role": "user", "content": "..."}]}`
- μ‘λ‹µ ν•μ‹: `{"choices": [{"message": {"content": "..."}}], "usage": {...}}`
- **Rate Limit**: ChatGPTμ κ²½μ° λ¶„λ‹Ή 3ν μ”μ²­ μ ν•μ„ μ¤€μν•κΈ° μ„ν•΄ μ”μ²­ κ°„ 21μ΄ λ€κΈ° λ΅μ§μ΄ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤.

| λ©”μ„λ“ | λ°ν™ νƒ€μ… | μ„¤λ… |
|--------|-----------|------|
| `summarize(text)` | `Dict[str, Any]` | ν…μ¤νΈ μ”μ•½ μ”μ²­ |

**μ‘λ‹µ κµ¬μ΅°**:
```python
# μ„±κ³µ
{"success": True, "content": "μ”μ•½...", "usage": {...}}

# μ‹¤ν¨
{"success": False, "error": "μ—λ¬ λ©”μ‹μ§€"}
```

---

### 2.3 parser.py
**μ—­ν• **: μΉ΄μΉ΄μ¤ν†΅ ν…μ¤νΈ νμΌ νμ‹±

**ν΄λμ¤**: `KakaoLogParser`

**μ§€μ› ν•μ‹**:
```
# PC/Mac: --------------- 2024λ…„ 1μ›” 24μΌ ---------------
# λ¨λ°”μΌ: 2024λ…„ 1μ›” 24μΌ μμ”μΌ
# μ‹¬ν”: 2024. 1. 24.
```

---

### 2.4 chat_processor.py
**μ—­ν• **: μ±„ν… ν…μ¤νΈ μ²λ¦¬ λ° ν¬λ§·ν…

**ν΄λμ¤**: `ChatProcessor(provider)`

| λ©”μ„λ“ | μ„¤λ… |
|--------|------|
| `process_summary(text)` | LLMμΌλ΅ μ”μ•½ ν›„ Markdown ν¬λ§·ν… |

---

### 2.5 date_summarizer.py
**μ—­ν• **: λ‚ μ§λ³„ μ „μ²΄ μ”μ•½ μ¤μΌ€μ¤νΈλ μ΄ν„°

**CLI μµμ…**:
```bash
python date_summarizer.py [--llm PROVIDER] <file_or_directory>
```

**ν΄λμ¤**:
- `DateSummarizer(filepath, provider)`: λ‹¨μΌ νμΌ μ²λ¦¬
- `BatchProcessor(directory, provider)`: λ””λ ‰ν„°λ¦¬ μΌκ΄„ μ²λ¦¬

---

### 2.6 yesterday_summarizer.py
**μ—­ν• **: μ–΄μ  λ‚ μ§λ§ μ”μ•½

**CLI μµμ…**:
```bash
python yesterday_summarizer.py [--llm PROVIDER] <file_or_directory>
```

---

### 2.7 url_extractor.py
**μ—­ν• **: URL μ¶”μ¶ λ° μ €μ¥

| ν•¨μ | μ„¤λ… |
|------|------|
| `extract_urls_from_text(text)` | ν…μ¤νΈμ—μ„ URL μ¶”μ¶ |
| `save_urls_to_file(dict, path)` | URL λ©λ΅ νμΌ μ €μ¥ |

---

## 3. λ°μ΄ν„° νλ¦„

```
[CLI μΈμ: --llm provider, file/directory]
       β”‚
       β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  config.py       β”‚  β† LLM μ κ³µμ μ„¤μ •
β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
         β”‚
         β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  KakaoLogParser   β”‚  β† λ‚ μ§λ³„ λ©”μ‹μ§€ κ·Έλ£Ήν™”
β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
         β”‚
         β–Ό  (λ‚ μ§λ³„ λ°λ³µ)
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  ChatProcessor    β”‚  β† LLMClient νΈμ¶
β”‚  + LLMClient      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
         β”‚
         β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  DateSummarizer   β”‚  β† ν†µν•© λ¦¬ν¬νΈ μƒμ„±
β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
         β”‚
         β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  url_extractor    β”‚  β† URL μ¶”μ¶
β””β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
         β”‚
         β–Ό
[μ¶λ ¥: _summaries.md, _url.txt]
```

---

## 4. μ—λ¬ μ²λ¦¬

| μ—λ¬ μ ν• | μ²λ¦¬ λ°©μ‹ |
|-----------|-----------|
| νμΌ μ—†μ | λ΅κ·Έ μ—λ¬ μ¶λ ¥ ν›„ μΆ…λ£ |
| API ν‚¤ μ—†μ | λ€ν™”ν• μ…λ ¥ μ”μ²­ |
| μλ»λ LLM μ κ³µμ | μ‚¬μ© κ°€λ¥ λ©λ΅ μ¶λ ¥ ν›„ μΆ…λ£ |
| API νƒ€μ„μ•„μ›ƒ | μ—λ¬ λ©”μ‹μ§€ λ°ν™, λ‹¤μ λ‚ μ§ κ³„μ† |
| API μ‘λ‹µ μ¤λ¥ | λ΅κ·Έ νμΌμ— μƒμ„Έ μ—λ¬ κΈ°λ΅, μ½μ†”μ—λ” μ¶•μ•½ λ©”μ‹μ§€ μ¶λ ¥ |

---

## 5. λ΅κΉ… μ‹μ¤ν…

**λ΅κ·Έ νμΌ**: `logs/summarizer_YYYYMMDD.log`

| λ λ²¨ | μ¶λ ¥ λ€μƒ | μ©λ„ |
|------|-----------|------|
| DEBUG | νμΌλ§ | API μ”μ²­/μ‘λ‹µ μƒμ„Έ μ •λ³΄ |
| INFO | νμΌλ§ | μ²λ¦¬ μ§„ν–‰ μƒν™© |
| WARNING | νμΌ + μ½μ†” | κ²½κ³  λ©”μ‹μ§€ |
| ERROR | νμΌ + μ½μ†” | μ—λ¬ μƒμ„Έ (μ½μ†”μ€ μ¶•μ•½) |

**ν•µμ‹¬ μ›μΉ™**: LLM API μ—λ¬ λ©”μ‹μ§€λ” `logs/` λ””λ ‰ν„°λ¦¬μ λ΅κ·Έ νμΌμ—λ§ κΈ°λ΅λλ©°, μ”μ•½ κ²°κ³Ό νμΌ(`*_summaries.md`)μ—λ” μ¤μ—Όλμ§€ μ•μµλ‹λ‹¤.
